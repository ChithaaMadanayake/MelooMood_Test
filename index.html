<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no, viewport-fit=cover" />
  <link rel="icon" href="{{ url_for('static', filename='images/logo.jpg') }}" type="image/jpeg">
  <title>MeloMood | Where Feelings Sound Better</title>  
  <link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}" />
  <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@600&family=Quicksand&display=swap" rel="stylesheet" />
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />
  <style>
    /* ðŸŒŠ Intro Page Styles */
      html {
        scroll-behavior: smooth;
      }
    * {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
    font-family: 'Quicksand', sans-serif;
  }

  body, html {
    height: 100%;
    background-color: black;
    scroll-behavior: smooth;
    overflow: hidden;

  }
  body {
    font-family: 'Poppins', sans-serif;
  }

  /* Glass UI */
  .ui-container {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    padding: 40px;
    width: 90%;
    max-width: 600px;
    background: rgba(255,255,255,0.08);
    border-radius: 20px;
    backdrop-filter: blur(20px);
    border: 1px solid rgba(255,255,255,0.2);
    text-align: center;
    color: #f8c79e;
    box-shadow: 0 0 20px rgba(0,255,255,0.2);
    line-height: 2 ;

  }
  .glass-container {
    background: rgba(255, 255, 255, 0.1);
    border-radius: 15px;
    backdrop-filter: blur(10px);
    -webkit-backdrop-filter: blur(10px);
    border: 1px solid rgba(255, 255, 255, 0.2);
    box-shadow: 0 4px 30px rgba(0, 0, 0, 0.1);
    padding: 20px;
}

  
  h1 {
    font-size: 3em;
    font-family: 'Orbitron', sans-serif;
    color: #00ffff;
    text-shadow: 0 0 10px #00ffffaa;
  }
  
  .subtitle {
    margin-top: 5px;
    font-size: 1.2em;
    color: #ffffffcc;
  }
  
  .cam-bubble {
    margin: 20px auto;
    width: 180px;
    height: 180px;
    border-radius: 50%;
    overflow: hidden;
    border: 4px solid #00ffff55;
    box-shadow: 0 0 15px #00ffff88;
  }
  #circleVideo {
    transition: opacity 0.5s ease;
    object-fit: cover;

  }
  
  #video {
    width: 100%;
    height: 100%;
    object-fit: cover;
  }
  
  .btn-container {
    margin-top: 20px;
  }
  
  .btn-glow {
    background-color: transparent;
    border: 2px solid #00ffff;
    padding: 12px 24px;
    margin: 5px;
    border-radius: 30px;
    color: #00ffff;
    font-size: 1em;
    cursor: pointer;
    transition: all 0.3s ease;
  }
  
  .btn-glow:hover {
    background-color: #00ffff33;
    box-shadow: 0 0 10px #00ffffcc;
  }
  
  .emotion-output:hover {
    transform: scale(1.05);
    color: #ffdd57;
    text-shadow: 0 0 15px #ffdd57aa;
    transition: 0.3s ease;
  }
  
  
  
  .player-bar {
    margin-top: 20px;
    background: rgba(0,0,0,0.3);
  }
  
  audio {
    background-color: rgba(255, 255, 255, 0.1); /* light transparent bg */
    backdrop-filter: blur(5px); 
    border-radius: 10px;
    padding: 5px;
    width: 520px;
    transition: background-color 0.3s ease;
    border: 1px solid rgba(255, 255, 255, 0.2);
  }
  audio:hover {
    background-color: rgba(255, 255, 255, 0.2);
  }
    
  audio::-webkit-media-controls-panel {
    background-color: rgba(255, 255, 255, 0.1) !important;
    backdrop-filter: blur(5px);
  }
  
  
  /* Animations */
  @keyframes fadeIn {
    from { opacity: 0; transform: translateY(10px); }
    to   { opacity: 1; transform: translateY(0); }
  }
/* Splash screen styles */
#splash-screen {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: black;
    z-index: 9999;
    display: flex;
    justify-content: center;
    align-items: center;
}

#splash-video {
    width: 100%;
    height: 100%;
    object-fit: cover;
}

/* Fade-out animation */
.fade-out {
    animation: fadeOut 2s ease-in-out forwards;
}

@keyframes fadeOut {
    to {
        opacity: 0;
        visibility: hidden;
    }
}@keyframes float {
    0% { transform: translateY(0); opacity: 1; }
    100% { transform: translateY(-100px); opacity: 0; }
  }
  .music-note {
    position: absolute;
    color: #00ffff;
    animation: float 3s ease-in infinite;
    font-size: 24px;
  }
.footer {
    background-color:  rgba(255, 255, 255, 0.1);
    color: #DFE4E7; 
    text-align: center;
    padding: 10px 0;
    position: fixed;
    width: 100%;
    bottom: 0;
    font-size: 14px;
    letter-spacing: 0.5px;
  }  
  

      .intro-section {
        position: relative;
        height: 100vh;
        width: 100%;
        justify-content: center;
        align-items: center;
        text-align: center;
        overflow: hidden;
      }

      .intro-section video {
        position: absolute;
        top: 0;
        left: 0;
        height: 100%;
        width: 100%;
        object-fit: cover;
        z-index: -3;
      }

      /* Gradient overlay */
      .intro-section::after {
        content: '';
        position: absolute;
        top: 0; left: 0;
        width: 100%; height: 100%;
        background: linear-gradient(to bottom right, rgba(0,0,0,0.6), rgba(15,15,60,0.9));
        z-index: -2;
      }

      /* Floating music icons */
      .floating-icons i {
        position: absolute;
        color: rgba(0, 204, 255, 0.3);
        font-size: 30px;
        animation: float 8s infinite ease-in-out;
        pointer-events: none;
      }

      .floating-icons i:nth-child(1) { top: 20%; left: 10%; animation-delay: 0s; }
      .floating-icons i:nth-child(2) { top: 30%; left: 80%; animation-delay: 2s; }
      .floating-icons i:nth-child(3) { top: 60%; left: 20%; animation-delay: 4s; }
      .floating-icons i:nth-child(4) { top: 75%; left: 70%; animation-delay: 6s; }
      .floating-icons i:nth-child(5) { top: 50%; left: 50%; animation-delay: 1s; }

      @keyframes float {
        0%, 100% { transform: translateY(0) rotate(0); opacity: 0.3; }
        50% { transform: translateY(-30px) rotate(20deg); opacity: 0.8; }
      }

      .intro-content {
        z-index: 1;
        padding: 40px 35px;
        border-radius: 20px;
        backdrop-filter: blur(12px);
        background: rgba(0, 0, 0, 0.3);
        border: 2px solid rgba(0, 204, 255, 0.3);
        box-shadow: 0 0 15px rgba(0, 204, 255, 0.3);
        animation: zoomIn 1s ease;
      }

      .intro-content h1 {
        font-size: 3.2em;
        margin-bottom: 15px;
        color: #00ccff;
        text-shadow: 0 0 12px #00ccff80;
      }

      .intro-content p {
        font-size: 1.2em;
        color: #e0e0e0;
        line-height: 1.6;
      }

      .typing-text {
        color: #ffffff;
        font-size: 1.1em;
        margin-top: 15px;
        font-style: italic;
        border-right: 2px solid #00ccff;
        white-space: nowrap;
        overflow: hidden;
        width: 0;
        animation: typing 4s steps(50, end) forwards, blink 0.75s infinite;
      }

      @keyframes typing {
        to { width: 100%; }
      }

      @keyframes blink {
        50% { border-color: transparent; }
      }

      .intro-btn {
        margin-top: 25px;
        padding: 14px 36px;
        font-size: 1.1em;
        font-weight: 600;
        background: linear-gradient(145deg, #00ccff, #0066ff);
        border: none;
        border-radius: 30px;
        color: white;
        cursor: pointer;
        box-shadow: 0 4px 20px rgba(0, 204, 255, 0.3);
        transition: all 0.3s ease;
      }

      .intro-btn:hover {
        background: linear-gradient(145deg, #0099cc, #0040cc);
        box-shadow: 0 6px 25px rgba(0, 153, 204, 0.6);
      }

      @keyframes zoomIn {
        from {
          transform: scale(0.95);
          opacity: 0;
        }
        to {
          transform: scale(1);
          opacity: 1;
        }
      }

      #main-section {
        display: none;
      }

      #intro {
        opacity: 1;
        transition: opacity 1s ease;
      }
    </style>

</head>
<body>

<!-- ðŸŒŠ Splash Screen -->
<div id="splash-screen">
  <video autoplay muted>
    <source src="{{ url_for('static', filename='splash.mp4') }}" type="video/mp4">
  </video>
</div>

<!-- ðŸŒŒ Particles Background -->
<canvas id="particles-bg"></canvas>

<!-- ðŸš€ Intro Section (First Page) -->
<section class="intro-section" id="intro">
  <div class="floating-icons">
    <i class="fas fa-music"></i>
    <i class="fas fa-headphones-alt"></i>
    <i class="fas fa-play-circle"></i>
    <i class="fas fa-heartbeat"></i>
    <i class="fas fa-wave-square"></i>
  </div>
  
  <video autoplay muted loop>
    <source src="{{ url_for('static', filename='bg_01.mp4') }}" type="video/mp4">
  </video>
  <div class="intro-content">
    <h1>Feel, Listen, Connect.</h1><br>
    <p>Your emotions are powerful, and with MeloMood, they come alive in sound. Powered by AI and your webcam, 
      it tunes into your feelings and creates the perfect playlist for your moodâ€”helping you feel seen, understood, and connected.</p><br><br><br>
    <p>Whether youâ€™re celebrating a joyful moment or navigating through a tough time, MeloMood is your personal soundtrack companion. It adapts with you, ensuring the music you hear mirrors your journey, lifting your spirits, 
      or offering comfort when you need it most. It's not just musicâ€”it's a reflection of you."</p><br>
    <button class="intro-btn" id="getStartedBtn">Get Started</button><br><br>
    <div class="typing-text">â™« Powered by AI. Tuned to You.</div>

  </div>
</section>

<!-- ðŸŽµ Main App Section (Second Page) -->
<section id="main-section" style="display: none;">
  <div class="ui-container">
    <h1>MeloMood</h1>
    <p class="subtitle">Your emotion-powered music buddy ðŸŽ§</p>

    <div class="cam-bubble">
      <video id="circle-video" autoplay loop muted playsinline>
        <source id="circle-source" src="{{ url_for('static', filename='circle1.mp4') }}" type="video/mp4" />
      </video>
      <video id="video" autoplay playsinline style="display: none;"></video>
      <canvas id="canvas" style="display:none;"></canvas>
    </div>

    <div class="btn-container">
      <button id="startWebcam" class="btn-glow">Start Webcam</button>
      <button id="captureButton" class="btn-glow" style="display:none;">Detect Emotion</button>
    </div>

    <div id="emotion-display" class="emotion-output"></div>

    <div class="player-bar">
      <audio id="music-player" controls style="display:none;" autoplay>
        <source id="music-source" src="" type="audio/mp3" />
      </audio>
    </div>
  </div>
</section>

<!-- ðŸ“œ Footer -->
<footer class="footer">
  <p>&copy; 2025 MeloMood | All rights reserved.</p>
</footer>
<script src="{{ url_for('static', filename='script.js') }}"></script>
<script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs"></script>
<script>
  const getStartedBtn = document.getElementById("getStartedBtn");
  const intro = document.getElementById("intro");
  const main = document.getElementById("main-section");

  getStartedBtn.addEventListener("click", (e) => {
    e.preventDefault();

    // 1. Fade out intro
    intro.style.transition = "opacity 1s ease";
    intro.style.opacity = "0";

    // 2. Show main-section after small delay
    setTimeout(() => {
      intro.style.display = "none";
      main.style.display = "block";
      main.scrollIntoView({ behavior: "smooth" });
    }, 1000); // matches the 1s fade
  });
  document.addEventListener("DOMContentLoaded", () => {
  const video        = document.getElementById("video");
  const circleVideo  = document.getElementById("circle-video");
  const circleSource = document.getElementById("circle-source");
  const canvas       = document.getElementById("canvas");
  const startBtn     = document.getElementById("startWebcam");
  const captureBtn   = document.getElementById("captureButton");
  const disp         = document.getElementById("emotion-display");
  const musicPlayer  = document.getElementById("music-player");
  const musicSource  = document.getElementById("music-source");
  const splashScreen = document.getElementById("splash-screen");
  const mainContent  = document.getElementById("main-content");

  let stream = null;

  // Splash screen
  setTimeout(() => {
    splashScreen.classList.add("fade-out");
    setTimeout(() => {
      splashScreen.style.display = "none";
      mainContent.style.display = "block";
      playRandomCircleVideo(); // Play random on page load
    }, 2000);
  }, 10000);
// Function to scroll to the main section
function scrollToMainSection() {
  const mainSection = document.getElementById("main-section");
  window.scrollTo({
    top: mainSection.offsetTop, 
    behavior: 'smooth'
  });
}
  // Play random circle video
  function playRandomCircleVideo() {
    const randomNum = Math.floor(Math.random() * 6) + 1; // 1 to 6
    const newPath = `/static/circle${randomNum}.mp4`;
    circleSource.src = newPath;
    circleVideo.load();
    circleVideo.play();
    circleVideo.style.display = "block";
    video.style.display = "none";
  }

  // Start webcam
  startBtn.addEventListener("click", async () => {
    try {
      stream = await navigator.mediaDevices.getUserMedia({ video: true });
      video.srcObject = stream;
      video.style.display = "block";
      circleVideo.pause();
      circleVideo.style.display = "none";
      captureBtn.style.display = "inline-block";
      startBtn.style.display = "none";
    } catch {
      alert("Webcam access denied.");
    }
  });

  // Capture and detect emotion
  captureBtn.addEventListener("click", async () => {
    // Stop any music
    musicPlayer.pause();
    musicPlayer.currentTime = 0;

    // Stop webcam before capture
    canvas.width = video.videoWidth;
    canvas.height = video.videoHeight;
    canvas.getContext("2d").drawImage(video, 0, 0);
    const imgData = canvas.toDataURL("image/png");

    // Turn off webcam
    if (stream) {
      stream.getTracks().forEach(track => track.stop());
      stream = null;
    }

    video.style.display = "none";
    disp.innerText = "Detecting emotionâ€¦";

    fetch("/detect-emotion", {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({ image: imgData })
    })
    .then(r => r.json())
    .then(data => {
      if (data.error) {
        disp.innerText = data.error;
        return;
      }

      disp.innerHTML = `<strong>${data.emotion}</strong><br>${data.message}`;

      // Play music
      if (data.music) {
        musicSource.src = data.music;
        musicPlayer.style.display = "block";
        musicPlayer.load();
        musicPlayer.play();
      }

      // After detection, show random video again
      setTimeout(() => {
        playRandomCircleVideo();
      }, 1000);
    })
    .catch(err => {
      console.error(err);
      disp.innerText = "Something went wrong.";
    });
  });

  // Optional: if music stops, still show random circle video
  musicPlayer.addEventListener("pause", () => {
    if (!video.srcObject) {
      playRandomCircleVideo();
    }
  });

  // Hide circle video when webcam is turned on
  startBtn.addEventListener("click", () => {
    circleVideo.style.display = "none";
    circleVideo.pause();
  });
});



</script>



</body>
</html>
